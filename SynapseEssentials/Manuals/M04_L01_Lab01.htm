<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-name:"List Paragraph\,Bullet List\,FooterText\,Procedure Step\,Procedure StepCxSpLast";
	mso-style-link:"List Paragraph Char\,Bullet List Char\,FooterText Char\,Procedure Step Char\,Procedure StepCxSpLast Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-name:"List Paragraph\,Bullet List\,FooterText\,Procedure Step\,Procedure StepCxSpLastCxSpFirst";
	mso-style-link:"List Paragraph Char\,Bullet List Char\,FooterText Char\,Procedure Step Char\,Procedure StepCxSpLast Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-name:"List Paragraph\,Bullet List\,FooterText\,Procedure Step\,Procedure StepCxSpLastCxSpMiddle";
	mso-style-link:"List Paragraph Char\,Bullet List Char\,FooterText Char\,Procedure Step Char\,Procedure StepCxSpLast Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-name:"List Paragraph\,Bullet List\,FooterText\,Procedure Step\,Procedure StepCxSpLastCxSpLast";
	mso-style-link:"List Paragraph Char\,Bullet List Char\,FooterText Char\,Procedure Step Char\,Procedure StepCxSpLast Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	font-size:14.0pt;
	font-family:"Segoe UI",sans-serif;
	color:#365F91;
	font-weight:bold;}
span.ListParagraphChar
	{mso-style-name:"List Paragraph Char\,Bullet List Char\,FooterText Char\,Procedure Step Char\,Procedure StepCxSpLast Char";
	mso-style-link:"List Paragraph\,Bullet List\,FooterText\,Procedure Step\,Procedure StepCxSpLast";
	font-family:"Cambria",serif;}
p.LabTitle, li.LabTitle, div.LabTitle
	{mso-style-name:"Lab Title";
	mso-style-link:"Lab Title Char";
	margin-top:24.0pt;
	margin-right:.1in;
	margin-bottom:12.0pt;
	margin-left:0in;
	page-break-before:always;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:20.0pt;
	font-family:"Segoe UI",sans-serif;
	color:#4F81BD;}
span.LabTitleChar
	{mso-style-name:"Lab Title Char";
	mso-style-link:"Lab Title";
	font-family:"Segoe UI",sans-serif;
	color:#4F81BD;}
p.TaskHeading, li.TaskHeading, div.TaskHeading
	{mso-style-name:"Task Heading";
	mso-style-link:"Task Heading Char";
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Segoe UI",sans-serif;
	font-weight:bold;}
p.TaskName, li.TaskName, div.TaskName
	{mso-style-name:"Task Name";
	mso-style-link:"Task Name Char";
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:6.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;
	color:black;
	font-weight:bold;}
span.TaskHeadingChar
	{mso-style-name:"Task Heading Char";
	mso-style-link:"Task Heading";
	font-family:"Segoe UI",sans-serif;
	font-weight:bold;}
p.TaskDetail, li.TaskDetail, div.TaskDetail
	{mso-style-name:"Task Detail";
	mso-style-link:"Task Detail Char";
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:6.0pt;
	margin-left:67.5pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;
	color:black;}
span.TaskNameChar
	{mso-style-name:"Task Name Char";
	mso-style-link:"Task Name";
	font-family:"Cambria",serif;
	color:black;
	font-weight:bold;}
p.ExerciseScenerio, li.ExerciseScenerio, div.ExerciseScenerio
	{mso-style-name:"Exercise Scenerio";
	mso-style-link:"Exercise Scenerio Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Cambria",serif;}
span.TaskDetailChar
	{mso-style-name:"Task Detail Char";
	mso-style-link:"Task Detail";
	font-family:"Cambria",serif;
	color:black;
	font-weight:normal;}
span.ExerciseScenerioChar
	{mso-style-name:"Exercise Scenerio Char";
	mso-style-link:"Exercise Scenerio";
	font-family:"Cambria",serif;}
p.CompletionMessage, li.CompletionMessage, div.CompletionMessage
	{mso-style-name:"Completion Message";
	mso-style-link:"Completion Message Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Cambria",serif;
	font-style:italic;}
span.CompletionMessageChar
	{mso-style-name:"Completion Message Char";
	mso-style-link:"Completion Message";
	font-family:"Cambria",serif;
	font-style:italic;}
p.ExerciseHeading, li.ExerciseHeading, div.ExerciseHeading
	{mso-style-name:"Exercise Heading";
	mso-style-link:"Exercise Heading Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Segoe UI",sans-serif;
	color:black;
	font-weight:bold;}
span.ExerciseHeadingChar
	{mso-style-name:"Exercise Heading Char";
	mso-style-link:"Exercise Heading";
	font-family:"Segoe UI",sans-serif;
	color:black;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	border:double windowtext 5.25pt;
	padding:24.0pt 24.0pt 24.0pt 24.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'><img width=624
height=226 id="Picture 40" src="M04_L01_Lab01_files/image001.png"></p>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-size:22.0pt;line-height:115%'>Securing Azure Synapse SQL Pool</span></b></p>

<p class=MsoNormal><b>Introduction</b></p>

<p class=MsoNormal>This lab introduces students to Azure Synapse SQL Transparent
Data Encryption (TDE) and other security techniques including Dynamic Data
Masking, Row Level and Object Level Security and Data Classification. It helps
student to understand how they can take advantage of the built-in security
mechanism.</p>

<p class=MsoNormal><b>Estimated Time</b></p>

<p class=MsoNormal>45 minutes</p>

<p class=MsoNormal><b>Objectives</b></p>

<p class=MsoNormal>At the end of this lab, you will be able to:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Enable Encryption for an Azure Synapse SQL Database</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Disable Encryption for an Azure Synapse SQL Database</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Implement Dynamic Data Masking</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Implement Row Level Security</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Implement Object Level Security</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Implement Data Classification via T-SQL</p>

<p class=MsoListParagraphCxSpLast>&nbsp;</p>

<p class=MsoNormal><b>Prerequisites</b></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>An Azure subscription. See Get Azure free trial.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Supported operating system to perform this class: Windows 10 /
Windows Server 2016 </p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#DBE5F1;margin-left:.25in;margin-right:0in'>

<p class=MsoListParagraphCxSpMiddle style='margin-left:0in;background:#DBE5F1;
border:none;padding:0in'><b><span style='color:black'>Note:</span></b><span
style='color:black'> The labs can be performed using your laptop environment
rather than LOD environment.</span></p>

</div>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>&nbsp;</p>

<p class=MsoTocHeading><span style='font-size:11.0pt;font-family:"Cambria",serif;
color:windowtext;font-weight:normal'>&nbsp;</span></p>

<p class=MsoTocHeading><span style='font-family:"Cambria",serif'>Table of
Contents</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoToc2><a href="#_Toc54135365">Lab 1: Securing Azure Synapse SQL Pool<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc3><a href="#_Toc54135366">Exercise 1: Enable Encryption on a
Synapse SQL Database from Azure Portal<span style='color:windowtext;display:
none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc3><a href="#_Toc54135367">Exercise 2: Disabling Encryption on a
Synapse SQL Database from Azure Portal<span style='color:windowtext;display:
none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></p>

<p class=MsoToc3><a href="#_Toc54135368">Exercise 3: Implementing Dynamic Data
Masking<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc3><a href="#_Toc54135369">Exercise 4: Implementing Row Level
Security<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></p>

<p class=MsoToc3><a href="#_Toc54135370">Exercise 5: Implementing Object Level
Security<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></p>

<p class=MsoToc3><a href="#_Toc54135371">Exercise 6: Implementing Data
Classification via T-SQL<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid #333399 1.0pt;padding:0in 0in 1.0pt 0in;
margin-left:0in;margin-right:.1in'>

<p class=LabTitle><a name="_Toc54135365"><span style='font-size:18.0pt;
font-family:"Cambria",serif'>Lab 1: Securing Azure Synapse SQL Pool</span></a></p>

</div>

<p class=MsoNormal>During this lab, you will  understand how to enable
Transparent Data Encryption (TDE) for Synapse SQL database. This lab also walks
through the implementation of Dynamic Data Masking to mask private data values,
as well as implementing Row Level Security and Object Level Security to secure
data access from end users. </p>

<p class=MsoNormal>&nbsp;</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=ExerciseHeading><a name="_Toc54135366"><span style='font-family:"Cambria",serif'>Exercise
1: Enable Encryption on a Synapse SQL Database from Azure Portal</span></a></p>

<p class=ExerciseScenerio>This exercise shows how to enable encryption on a Synapse
SQL Database from Azure Portal.</p>

<p class=TaskHeading><span style='font-family:"Cambria",serif'>Tasks</span></p>

<p class=TaskName>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Sign in the <a href="https://portal.azure.com/">Azure Portal</a>,
navigate to Azure SQL Databases</p>

<p class=TaskDetail style='margin-left:.75in'>On search pane, search for “SQL
Dat…”, then select “SQL Databases”</p>

<p class=TaskDetail style='margin-left:.75in'>&nbsp;</p>

<p class=TaskDetail style='margin-left:.75in'><img border=0 width=557
height=116 id="Picture 1" src="M04_L01_Lab01_files/image002.jpg"></p>

<p class=TaskDetail style='margin-left:.75in'>&nbsp;</p>

<p class=TaskName>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Find the instance of Synapse SQL database you want to enable encryption
on, and then select it</p>

<p class=TaskDetail style='margin-left:.75in'>From the displayed list of SQL
Databases, select the Azure Synapse SQL Database you want to enable encryption.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img border=0 width=623 height=136 id="Picture 50"
src="M04_L01_Lab01_files/image003.jpg"></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TaskName style='margin-left:.5in;text-indent:0in'>&nbsp;</p>

<p class=TaskName>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Select “Transparent data encryption” on the Azure Synapse SQL Database
blade</p>

<p class=TaskDetail style='margin-left:.75in'>Form the data warehouse database
blade, select “Transparent data encryption”</p>

<p class=TaskDetail style='margin-left:.75in'><img border=0 width=187
height=359 id="Picture 54" src="M04_L01_Lab01_files/image004.jpg"></p>

<p class=TaskName>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Select “ON” Encryption Settings, then click Save.</p>

<p class=TaskName style='text-indent:0in'><img border=0 width=548 height=239
id="Picture 62" src="M04_L01_Lab01_files/image005.jpg"></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TaskName style='text-indent:0in'><span style='font-weight:normal'>Encryption
will be started and will show status as “Updating TDE setting…”</span></p>

<p class=TaskName style='text-indent:0in'><img border=0 width=420 height=209
id="Picture 655" src="M04_L01_Lab01_files/image006.jpg"></p>

<p class=TaskDetail style='margin-left:.75in'>&nbsp;</p>

<p class=TaskDetail style='margin-left:.75in'>The database will be encrypted
after some time and will show as encrypted</p>

<p class=TaskDetail style='margin-left:.75in'><img border=0 width=453
height=230 id="Picture 658" src="M04_L01_Lab01_files/image007.jpg"></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TaskDetail style='margin-left:.5in'>&nbsp;</p>

<p class=TaskDetail style='margin-left:.75in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Encryption
can be confirmed with the following DMVs:</p>

<p class=TaskDetail style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>sys.databases</p>

<p class=TaskDetail style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>sys.dm_pdw_nodes_database_encryption_keys</p>

<p class=TaskDetail style='margin-left:.75in'>For example, running the query
below, in SSMS, against your Azure Synapse SQL Database will confirm if the
encryption is enabled (1).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75in;line-height:normal;text-autospace:none'><span
style='font-size:9.5pt;color:blue'>SELECT </span><span style='font-size:9.5pt;
color:black'>[name]</span><span style='font-size:9.5pt;color:gray'>, </span><span
style='font-size:9.5pt;color:black'>[is_encrypted]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75in;line-height:normal;text-autospace:none'><span
style='font-size:9.5pt;color:blue'>FROM </span><span style='font-size:9.5pt;
color:black'>    </span><span style='font-size:9.5pt;color:green'>sys</span><span
style='font-size:9.5pt;color:gray'>.</span><span style='font-size:9.5pt;
color:green'>databases</span><span style='font-size:9.5pt;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75in;line-height:normal;text-autospace:none'><span
style='font-size:9.5pt;color:gray'>&nbsp;</span></p>

<p class=TaskDetail style='margin-left:0in'>                             <img
border=0 width=216 height=162 id="Picture 662"
src="M04_L01_Lab01_files/image008.jpg"></p>

<p class=TaskDetail style='margin-left:.75in'>&nbsp;</p>

<p class=CompletionMessage>Exercise 1 has been completed</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=ExerciseHeading><a name="_Toc54135367"><span style='font-family:"Cambria",serif'>Exercise
2: Disabling Encryption on a Synapse SQL Database from Azure Portal</span></a></p>

<p class=ExerciseScenerio>In this exercise you will disable encryption on a Synapse
SQL Database from Azure portal. To do this, please follow below tasks.</p>

<p class=TaskHeading><span style='font-family:"Cambria",serif'>Tasks</span></p>

<p class=TaskName><span style='font-weight:normal'>In Azure Portal</span></p>

<p class=TaskName>&nbsp;</p>

<p class=TaskName>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Select “Transparent data encryption”</p>

<p class=TaskDetail style='margin-left:.75in'>Form the data warehouse database
blade, select “Transparent data encryption”</p>

<p class=TaskDetail style='margin-left:.75in'><img border=0 width=153
height=294 id="Picture 661" src="M04_L01_Lab01_files/image009.jpg"></p>

<p class=TaskName>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Select “OFF” Encryption Settings, then click Save.</p>

<p class=TaskName style='text-indent:0in'><img border=0 width=565 height=231
id="Picture 663" src="M04_L01_Lab01_files/image010.jpg"></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TaskName style='text-indent:0in;line-height:normal'><span
style='font-weight:normal'>Decryption will be started on the database, even
though there is no progress bar.</span></p>

<p class=TaskDetail style='margin-left:.75in;line-height:normal'>Once the
database will be decrypted after some time and will show as Unencrypted</p>

<p class=TaskDetail style='margin-left:.75in'><img border=0 width=401
height=208 id="Picture 665" src="M04_L01_Lab01_files/image011.jpg"></p>

<p class=TaskDetail style='margin-left:.75in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Confirm
that the DB is decrypted, using one of the following with the following DMVs:</p>

<p class=TaskDetail style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>sys.databases</p>

<p class=TaskDetail style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>sys.dm_pdw_nodes_database_encryption_keys</p>

<p class=TaskDetail style='margin-left:.75in'>In this example, let us use the
query below, in VS2007, against your Azure Synapse SQL Database will show the
encryption status.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75in;line-height:normal;text-autospace:none'><span
style='font-size:9.5pt;color:blue'>SELECT</span><span style='font-size:9.5pt;
color:black'> </span><span style='font-size:9.5pt;color:fuchsia'>DB_ID</span><span
style='font-size:9.5pt;color:gray'>();</span><span style='font-size:9.5pt;
color:black'>  </span><span style='font-size:9.5pt;color:green'>-- gives me 6,
for my database ID</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75in;line-height:normal;text-autospace:none'><span
style='font-size:9.5pt;color:blue'>Select</span><span style='font-size:9.5pt;
color:black'> </span><span style='font-size:9.5pt;color:gray'>*</span><span
style='font-size:9.5pt;color:black'> </span><span style='font-size:9.5pt;
color:blue'>from</span><span style='font-size:9.5pt;color:black'> </span><span
style='font-size:9.5pt;color:green'>sys</span><span style='font-size:9.5pt;
color:gray'>.</span><span style='font-size:9.5pt;color:black'>dm_pdw_nodes_database_encryption_keys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75in;line-height:normal;text-autospace:none'><span
style='font-size:9.5pt;color:blue'>where</span><span style='font-size:9.5pt;
color:black'> database_id </span><span style='font-size:9.5pt;color:gray'>=</span><span
style='font-size:9.5pt;color:black'> 6</span></p>

<p class=TaskDetail style='margin-left:0in'>                             <br
clear=all style='page-break-before:always'>
</p>

<p class=TaskDetail style='margin-left:0in'><b>&nbsp;</b></p>

<p class=TaskName style='text-indent:0in'><span style='font-weight:normal'>The
result is:</span></p>

<p class=TaskName style='text-indent:0in'><img border=0 width=336 height=41
id="Picture 666" src="M04_L01_Lab01_files/image012.png"></p>

<table class=MsoTable15Grid6ColorfulAccent5 border=1 cellspacing=0
 cellpadding=0 width=524 style='width:392.9pt;margin-left:58.25pt;border-collapse:
 collapse;border:none'>
 <tr style='height:84.05pt'>
  <td width=139 valign=top style='width:104.25pt;border:solid #92CDDC 1.0pt;
  border-bottom:solid #92CDDC 1.5pt;padding:0in 5.4pt 0in 5.4pt;height:84.05pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>encryption_state</span></p>
  </td>
  <td valign=top style='border-top:solid #92CDDC 1.0pt;border-left:none;
  border-bottom:solid #92CDDC 1.5pt;border-right:solid #92CDDC 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:84.05pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>int</span></p>
  </td>
  <td valign=top style='border-top:solid #92CDDC 1.0pt;border-left:none;
  border-bottom:solid #92CDDC 1.5pt;border-right:solid #92CDDC 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:84.05pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Indicates whether the database on this node is encrypted
  or not encrypted.<br>
  <br>
  0 = No database encryption key present, no encryption</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>1 = Unencrypted</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>2 = Encryption in progress</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>3 = Encrypted</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>4 = Key change in progress</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>5 = Decryption in progress</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>6 = Protection change in progress (The certificate that
  is encrypting the database encryption key is being changed.)</span></p>
  </td>
 </tr>
</table>

<p class=TaskName style='margin-left:0in;text-indent:0in'><span
style='font-weight:normal'>&nbsp;</span></p>

<p class=CompletionMessage>Exercise 2 has been completed</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=MsoListParagraph style='margin-left:.25in'>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#B6DDE8'>

<p class=MsoNormal style='background:#B6DDE8;border:none;padding:0in'><b><span
style='color:black'>Note: </span></b><span style='color:black'>Leave the Azure
portal connection open – you will be using it throughout the Lab.</span></p>

</div>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=ExerciseHeading><a name="_Toc54135368"><span style='font-family:"Cambria",serif'>Exercise
3: Implementing Dynamic Data Masking</span></a></p>

<p class=ExerciseScenerio>In this exercise you will create a table and mask the
column values on the fly when being queried from client applications.</p>

<p class=TaskHeading><span style='font-family:"Cambria",serif'>Tasks</span></p>

<p class=TaskName><span style='font-weight:normal'>In SSMS</span></p>

<p class=TaskName>&nbsp;</p>

<p class=TaskName><span style='font-weight:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Launch SQL Server Management Studio<span style='font-weight:normal'>
and connect to the </span>Synapse SQL instance<span style='font-weight:normal'>
using </span>SQLAdmin<span style='font-weight:normal'> login.</span></p>

<p class=TaskName><span style='font-weight:normal'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-weight:normal'>In SSMS, Navigate to </span>C:\LabFiles\Module4\<span
style='font-weight:normal'> and open the file </span>Dynamic Data Masking.sql<span
style='font-weight:normal'>.</span> </p>

<p class=TaskName style='text-indent:0in'><span style='font-weight:normal'>File
Dynamic Data Masking.SQL is embedded in this document below.</span></p>

<p class=TaskName><span style='font-weight:normal'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Run<span style='font-weight:normal'> the statements sequentially.
Each statement has comments inline for your reference.</span></p>

<p class=TaskName style='margin-left:.5in;text-indent:0in'><img border=0
width=99 height=65 src="M04_L01_Lab01_files/image013.png"></p>

<p class=MsoListParagraph style='margin-left:.25in'>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#B6DDE8'>

<p class=MsoNormal style='background:#B6DDE8;border:none;padding:0in'><b><span
style='color:black'>Note: </span></b><span style='color:black'>Leave Visual
Studio / SSMS open – you will be using it throughout the Lab.</span></p>

</div>

<p class=TaskName style='margin-left:.5in;text-indent:0in'><span
style='font-weight:normal'>&nbsp;</span></p>

<p class=TaskName style='margin-left:.5in;text-indent:0in'><span
style='font-weight:normal'>&nbsp;</span></p>

<p class=CompletionMessage>Exercise 3 has been completed<a name="_Toc20944930"></a></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=ExerciseHeading><a name="_Toc54135369">Exercise 4: Implementing Row
Level Security</a></p>

<p class=ExerciseScenerio>In this exercise you will implement Row Level
Security over tables and limiting the records that can be queried by end user.</p>

<p class=TaskHeading>Tasks</p>

<p class=TaskName><span style='font-weight:normal'>In SSMS</span></p>

<p class=TaskName><span style='font-weight:normal'>&nbsp;</span></p>

<p class=TaskName><span style='font-weight:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-weight:normal'>In a typical Data Warehouse,
enterprise managed security table would be used to implement data security which
could be implemented after the IT Security governance process and approvals.
This lab will take the same approach to walkthrough on how to use security
table to implement row level security. </span>Run<span style='font-weight:normal'>
the following query to create a security table and TripsHash table:</span></p>

<p class=TaskName style='text-indent:0in'>

<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=113 height=3945></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=408 height=259 src="M04_L01_Lab01_files/image014.png"
  alt="CREATE TABLE [NYCTaxi].[SecurityLocationAnalyst]&#13;&#10;(&#13;&#10;    LocationID int,&#13;&#10;    Analyst sysname&#13;&#10;);&#13;&#10;&#13;&#10;CREATE TABLE NYCTaxi.TripsHash&#13;&#10;WITH&#13;&#10;(&#13;&#10;	CLUSTERED INDEX (PULocationID),&#13;&#10;    DISTRIBUTION = HASH ( PULocationID )&#13;&#10;)&#13;&#10;AS SELECT * FROM NYCTaxi.Trips&#13;&#10;&#13;&#10;&#13;&#10;"></td>
 </tr>
</table>

<span style='font-weight:normal'>&nbsp;</span></p>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<br clear=ALL>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run</b>
the following query to insert some records:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><b><img border=0
width=397 height=147 src="M04_L01_Lab01_files/image015.png"
alt="INSERT INTO [NYCTaxi].[SecurityLocationAnalyst] VALUES &#13;&#10;(197, 'Analyst1')&#13;&#10; &#13;&#10;INSERT INTO [NYCTaxi].[SecurityLocationAnalyst] VALUES &#13;&#10;(192, 'Analyst2')&#13;&#10;&#13;&#10;INSERT INTO [NYCTaxi].[SecurityLocationAnalyst] VALUES &#13;&#10;(247, 'Analyst3')&#13;&#10;"></b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>Querying the
table would show as below:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=162 height=83 id="Picture 667" src="M04_L01_Lab01_files/image016.png"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>Maintainability
is one of the advantages of a security table. Assume if Analyst2 has been
changed location, the updates can be reflected on the security table and row
level security requires no further maintenance.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run</b>
the following query to create SQL users to simulate the query later:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=303 height=97 src="M04_L01_Lab01_files/image017.png"
alt="CREATE USER Analyst1 WITHOUT LOGIN;&#13;&#10;CREATE USER Analyst2 WITHOUT LOGIN;&#13;&#10;CREATE USER Analyst3 WITHOUT LOGIN;&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run</b>
the following query to grant SELECT over the two tables for the SQL user
created:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=537 height=152 src="M04_L01_Lab01_files/image018.png"
alt="GRANT SELECT ON [NYCTaxi].[TripsHash] TO Analyst1;&#13;&#10;GRANT SELECT ON [NYCTaxi].[TripsHash] TO Analyst2;&#13;&#10;GRANT SELECT ON [NYCTaxi].[TripsHash] TO Analyst3;&#13;&#10;GRANT SELECT ON [NYCTaxi].[SecurityLocationAnalyst] TO Analyst1;&#13;&#10;GRANT SELECT ON [NYCTaxi].[SecurityLocationAnalyst] TO Analyst2;&#13;&#10;GRANT SELECT ON [NYCTaxi].[SecurityLocationAnalyst] TO Analyst3;&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run</b>
the following query to create the security function that will has a single
parameter for LocationID and returning only the rows based on the user querying
the table:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=577 height=199 src="M04_L01_Lab01_files/image019.png"
alt="CREATE SCHEMA Security;&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE FUNCTION [Security].[fn_securitypredicate](@LocationID AS int)&#13;&#10;    RETURNS TABLE&#13;&#10;WITH SCHEMABINDING&#13;&#10;AS&#13;&#10;    RETURN SELECT result = 1&#13;&#10;	FROM [NYCTaxi].[SecurityLocationAnalyst]&#13;&#10;	WHERE Analyst = USER_NAME() AND LocationID = @LocationID&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>The parameter
LocationID defines the filter predicate being passed on from the TripsHash
table which is defined in the next step for security policy. The WHERE clause
for Analyst limits the rows only for the respective Analyst and its LocationID
as defined in the security table.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run</b>
the following query to create a security policy adding the function as a filter
predicate:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=537 height=103 src="M04_L01_Lab01_files/image020.png"
alt="CREATE SECURITY POLICY SalesFilter&#13;&#10;ADD FILTER PREDICATE Security.fn_securitypredicate(PULocationID) &#13;&#10;ON [NYCTaxi].[TripsHash]&#13;&#10;WITH (STATE = ON);&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run</b>
the following query to query the table as Analyst2. Based on the security
table, Analyst2 can query only Trips picked up at PULocationID 192.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=303 height=83 src="M04_L01_Lab01_files/image021.png"
alt="EXECUTE AS USER = 'Analyst2'&#13;&#10;SELECT * FROM [NYCTaxi].[TripsHash]&#13;&#10;REVERT;&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=624 height=210 id="Picture 4" src="M04_L01_Lab01_files/image022.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>Notice the total
number of rows is 2,953 for PULocationID 192. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><b>Run</b> the
above query again as Analyst1 and observe the PULocationID and number of rows
returned.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Distinct
of PULocationID returns only a single location based on the security table.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=263 height=95 src="M04_L01_Lab01_files/image023.png"
alt="EXECUTE AS USER = 'Analyst1'&#13;&#10;SELECT DISTINCT [PULocationID]&#13;&#10;FROM [NYCTaxi].[TripsHash]&#13;&#10;REVERT;&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=116 height=40 id="Picture 5" src="M04_L01_Lab01_files/image024.png"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Run
the following query to add another Location for Analyst2:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=456 height=57 src="M04_L01_Lab01_files/image025.png"
alt="INSERT INTO [NYCTaxi].[SecurityLocationAnalyst] VALUES &#13;&#10;(197, 'Analyst2')&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Distinct of
PULocationID now returns two location IDs based on the security table for
Analyst2.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=263 height=95 src="M04_L01_Lab01_files/image026.png"
alt="EXECUTE AS USER = 'Analyst2'&#13;&#10;SELECT DISTINCT [PULocationID]&#13;&#10;FROM [NYCTaxi].[TripsHash]&#13;&#10;REVERT;&#13;&#10;"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img border=0
width=121 height=61 id="Picture 6" src="M04_L01_Lab01_files/image027.png"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
margin-bottom:8.0pt;margin-left:.75in;text-indent:-.25in;line-height:107%'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Cleanup objects.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in'><img width=422
height=191 src="M04_L01_Lab01_files/image028.png" align=left hspace=12
vspace=5
alt="DROP SECURITY POLICY SalesFilter&#13;&#10;DROP FUNCTION  [Security].[fn_securitypredicate]&#13;&#10;DROP SCHEMA Security&#13;&#10;&#13;&#10;DROP USER Analyst1;&#13;&#10;DROP USER Analyst2;&#13;&#10;DROP USER Analyst3;&#13;&#10;&#13;&#10;DROP TABLE  [NYCTaxi].[SecurityLocationAnalyst]&#13;&#10;"></p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in'>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<p class=CompletionMessage>Exercise 4 has been completed</p>

<p class=MsoListParagraph style='margin-left:.75in'>&nbsp;</p>

<p class=CompletionMessage>&nbsp;</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=ExerciseHeading><a name="_Toc54135370"><span style='font-family:"Cambria",serif'>Exercise
5: Implementing Object Level Security</span></a></p>

<p class=ExerciseScenerio>In this exercise you will create a table secure the
columns from being queried by users.</p>

<p class=TaskHeading><span style='font-family:"Cambria",serif'>Tasks</span></p>

<p class=TaskHeading><span style='font-family:"Cambria",serif;font-weight:normal'>            </span><span
style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif;
font-weight:normal'>In SSMS.</span></p>

<p class=TaskHeading><span style='font-size:11.0pt;line-height:115%;font-family:
"Cambria",serif;font-weight:normal'>&nbsp;</span></p>

<p class=TaskName><span style='font-weight:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-weight:normal'>Navigate to </span>C:\LabFiles\Module4\<span
style='font-weight:normal'> and open the file </span>Object Level Security.sql<span
style='font-weight:normal'>. </span></p>

<p class=TaskName style='text-indent:0in'><span style='font-weight:normal'>File
‘Object Level Security.SQL’ is embedded in this doc below.</span></p>

<p class=TaskName><span style='font-weight:normal'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-weight:normal'>Execute the query in SSMS..</span></p>

<p class=TaskName><span style='font-weight:normal'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Run<span style='font-weight:normal'> the statements sequentially.
Each statement has comments inline for your reference.</span></p>

<p class=TaskName style='margin-left:.5in;text-indent:0in'><span
style='font-weight:normal'>&nbsp;</span></p>

<p class=CompletionMessage>Exercise 5 has been completed</p>

<p class=CompletionMessage>&nbsp;</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Cambria",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=ExerciseHeading><a name="_Toc54135371"><span style='font-family:"Cambria",serif'>Exercise
6: Implementing Data Classification via T-SQL</span></a></p>

<p class=CompletionMessage>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#DBE5F1;margin-left:0in;margin-right:.1in'>

<p class=TaskDetail style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:#DBE5F1;border:none;padding:0in'><b>Note: </b>This is
an optional lab and can be completed based on time availability.</p>

</div>

<p class=ExerciseScenerio>&nbsp;</p>

<p class=ExerciseScenerio>In this exercise you will create a table and mask the
column values on the fly when being queried from client applications.</p>

<p class=TaskHeading><span style='font-family:"Cambria",serif'>Tasks</span></p>

<p class=TaskName><span style='font-weight:normal'>In SSMS</span></p>

<p class=TaskName style='text-indent:0in'>&nbsp;</p>

<p class=TaskName><span style='font-weight:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-weight:normal'>Navigate to </span>C:\LabFiles\Module4\<span
style='font-weight:normal'> and open the file </span>Data Classifications.sql<span
style='font-weight:normal'>. </span></p>

<p class=TaskName style='text-indent:0in'><span style='font-weight:normal'>File
‘Data Classifications.SQL’ is embedded in this doc below.</span></p>

<p class=TaskName><span style='font-weight:normal'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-weight:normal'>Execute the query in SSMS..</span></p>

<p class=TaskName><span style='font-weight:normal'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Run<span style='font-weight:normal'> the statements sequentially.
Each statement has comments inline for your reference.</span></p>

<p class=TaskName style='margin-left:.5in;text-indent:0in'><img border=0
width=99 height=65 src="M04_L01_Lab01_files/image029.png"></p>

<p class=CompletionMessage>Exercise 6 has been completed</p>

<p class=ExerciseHeading><span style='font-family:"Cambria",serif'>&nbsp;</span></p>

<p class=CompletionMessage>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#DBE5F1;margin-left:0in;margin-right:.1in'>

<p class=TaskDetail style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:#DBE5F1;border:none;padding:0in'><b>Important:</b>
Please pause your Synapse SQL Pool upon completing this lab. Do resume the SQL
Pool instance when you start working with the exercises. This is to prevent
from reaching the credit limit throughout the workshop.</p>

</div>

<p class=MsoNormal><b><span style='color:black'>&nbsp;</span></b></p>

</div>

</body>

</html>
